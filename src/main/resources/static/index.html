<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Basket</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/header.css">
</head>
<body>

<header>
    <div id="headerImage"></div>
    <div id="headerInfo">
        <p>Курсовая работа "Баскетбол в школах"</p>
        <p>Группа Р33301</p>
        <p>Геллер Леонид, Савон Галина</p>
    </div>
    <div id="headerMenu">
        <div><p>Таблица</p></div>
        <div><p>Статистика</p></div>
    </div>
</header>

<div class="team welcomeMessage">
    <p>Лидеры текущего турнира:</p>
</div>
<div id="wrapper">
    <table id="tournamentTable">
        <tr>
            <th>Позиция</th>
            <th>Лого</th>
            <th>Клуб</th>
            <th>Игры</th>
            <th>Победы</th>
            <th>Ничьи</th>
            <th>Поражения</th>
            <th>Очки дома</th>
            <th>Очки в гостях</th>
            <th>Очки в турнире</th>
        </tr>
    </table>
</div>

<script>

    document.addEventListener("DOMContentLoaded", function(event) {
        fetch("teaminfo", {
            method: "get",
            headers: { "Content-Type": "application/json" }
        })
            .then(resp => {
                if (resp.status === 200) {
                    return resp.json()
                } else {
                    console.log("Status: " + resp.status)
                    return Promise.reject("server")
                }
            })
            .then(dataJson => {
                console.log(dataJson);
                position = 1;
                dataJson.teamInfo.forEach(function (team) {
                    document.getElementById("tournamentTable").innerHTML +=
                        `<tr>
                            <td>${position}</td>
                            <td><img height="50px" src="img/team/team${team.photo_id}.jpg" alt="team logo"></td>
                            <td><a href="team.html?id=${team.teamId}">${team.name}</a></td>
                            <td><p>${team.games_count}</p></td>
                            <td><p>${team.victories}</p></td>
                            <td><p>${team.draws}</p></td>
                            <td><p>${team.games_count - (team.victories + team.draws)}</p></td>
                            <td><p>${team.scored_home}</p></td>
                            <td><p>${team.scored_guest}</p></td>
                            <td><p>${team.tournament_score}</p></td>
                        </tr>`
                    position++;
                });
            })
            .catch(err => {
                if (err === "server") return
                console.log(err)
            })

    });
</script>
</body>
</html>

